id: aiostreams-api
name: AIOStreams (API)
description: "A custom Prowlarr indexer for the AIOStreams torrent/debrid search add-on using the Search API"
language: en-US
type: public
encoding: UTF-8
followredirect: false
testlinktorrent: false
requestDelay: 5
links:
  - http://aiostreams:3000
  - https://aiostreams.viren070.me
  - https://aiostreamsfortheweak.nhyira.dev
  - https://aio.viren070.me
  - https://aiostreams.stremio.ru
  - https://aio.atbphosting.com
caps:
  categories:
    Movies: Movies
    TV: TV
  modes:
    search: [q]
    movie-search: [q, imdbid]
    tv-search: [q, imdbid, season, ep]
  allowrawsearch: false
settings:
  - name: auth
    type: text
    label: Base64 config (uuid:password in base64)
  - name: validate_imdb_movie
    type: text
    label: IMDB ID of Movie to use for Radarr validation (must exist in indexer)
    default: "tt0137523"
  - name: validate_imdb_tv
    type: text
    label: IMDB ID TV show to use for Sonarr validation (must exist in indexer)
    default: "tt9288030"
search:
  headers:
    Authorization: ["Basic {{ .Config.auth }}"]
  paths:
    - path: /api/v1/search?type=movie&id={{ if .Query.IMDBID }}{{ .Query.IMDBID }}{{ else }}{{ .Config.validate_imdb_movie }}{{ end }}&requiredFields=infoHash
      method: get
      response:
        type: json
        noResultsMessage: '"results": []'
      categories: [Movies]

    - path: /api/v1/search?type=series&id={{ if .Query.IMDBID }}{{ .Query.IMDBID }}{{ else }}{{ .Config.validate_imdb_tv }}{{ end }}:{{ if .Query.Season }}{{ .Query.Season }}{{ else }}1{{ end }}:{{ if .Query.Ep }}{{ .Query.Ep }}{{ else }}1{{ end }}&requiredFields=infoHash
      method: get
      response:
        type: json
        noResultsMessage: '"results": []'
      categories: [TV]
  rows:
    selector: data.results
    missingAttributeEqualsNoResults: true

  fields:
    title:
      selector: filename
      default: "Unknown Title"
      filters:
        - name: trim
    year:
      selector: filename
      optional: true
      filters:
        - name: regexp
          args: "(\\b(19|20)\\d{2}\\b)"
    category_is_tv_show:
      text: "{{ .Result.title }}"
      filters:
        - name: regexp
          args: "\\b(S\\d+(?:E\\d+)?)\\b"
    category:
      text: "{{ if .Result.category_is_tv_show }}TV{{ else }}Movies{{ end }}"
    infohash_selector:
      optional: true
      selector: infoHash
    infohash:
      text: "{{ if .Result.infohash_selector }}{{ .Result.infohash_selector }}{{ else }}0000000000000000000000000000000000000000{{ end }}"
    size:
      selector: size
      filters:
        - name: regexp
          args: "^(\\d+)$"
        - name: replace
          args:
            - "^(\\d{10,})$"
            - "{{ div .Value 1073741824.0 | printf \"%.2f\" }} GB"
        - name: replace
          args:
            - "^(\\d+)$"
            - "{{ div .Value 1048576.0 | printf \"%.2f\" }} MB"
    quality:
      selector: filename
      filters:
        - name: regexp
          args: "\\b2160p|1080p|720p|480p\\b"
    date:
      text: "Apr. 18th '11"
      filters:
        - name: re_replace
          args: ["st|nd|rd|th", ""]
        - name: replace
          args: ["'", ""]
        - name: dateparse
          args: "MMM. d yy"
    seed_count:
      selector: seeders
      optional: true
    seeders:
      text: "{{ if .Result.seed_count }}{{ .Result.seed_count }}{{ else }}0{{ end }}"
    leechers:
      text: "0"